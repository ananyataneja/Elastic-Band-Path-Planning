image:
  file: .gitpod.Dockerfile

ports:
  - port: 6080
    onOpen: open-preview

tasks:
  - name: Start JavaFX App
    init: |
      echo "üöÄ Installing dependencies..."
      sudo apt-get update
      sudo apt-get install -y openjfx tigervnc-standalone-server novnc websockify
    command: |
      vncserver :1 -geometry 1024x768 -localhost no
      websockify --web /usr/share/novnc/ 6080 localhost:5901 &

      echo "‚è≥ Waiting for VNC display to be ready..."
      for i in {1..15}; do
        if [ -e /tmp/.X11-unix/X1 ]; then
          echo "‚úÖ VNC server is ready."
          break
        fi
        sleep 1
      done

      echo "üî® Compiling JavaFX program..."
      javac --module-path /usr/share/openjfx/lib --add-modules javafx.controls,javafx.fxml ElasticBandImplement.java

      echo "‚ñ∂Ô∏è Running JavaFX program..."
      export DISPLAY=:1
      DISPLAY=:1 java --module-path /usr/share/openjfx/lib --add-modules javafx.controls,javafx.fxml ElasticBandImplement
